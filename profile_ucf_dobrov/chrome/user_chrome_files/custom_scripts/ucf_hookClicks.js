/* hookMouseKeys ¬© Dumby, mod 3.0 Dobrov. –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
Keys –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à Menu –∫–æ–º–∞–Ω–¥—ã Mouse –∫–ª–∏–∫–∏ –º—ã—à–∏ Setup –æ–ø—Ü–∏–∏ */

(async (Ff,init) =>{ Tag = {"downloads-button":`{`+ //–ø–æ–¥—Å–∫–∞–∑–∫–∏ –∫–Ω–æ–ø–æ–∫
`‚óâ –∫–æ–ª—ë—Å–∏–∫–æ	‚¨áÔ∏é –ø–∞–ø–∫–∞ [–ó–∞–≥—Ä—É–∑–∫–∏]
‚ó® –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚ûú –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–∞–π—Ç
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ –Ω–∞ –§–æ—Ç–æ ‚ûú –°–æ—Ö—Ä–∞–Ω–∏—Ç—åÔ∏∞`+ //–Ω—É–∂–µ–Ω SingleHTML.jsm

`‚óß –ª–µ–≤–æ –î–µ—Ä–∂–∞—Ç—å ‚¨áÔ∏é –ø–∞–ø–∫–∞ [–ó–∞–≥—Ä—É–∑–∫–∏]\n
‚ó® –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ (Alt+S) ‚ûú –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\n    –≤ –µ–¥–∏–Ω—ã–π Html –≤—Å—ë / –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ, ${Ff.Ctr("Super","Ctrl+Shift")}+S –∫–∞–∫ –¢–µ–∫—Å—Ç\n
‚óß –¥–≤–∞–∂–¥—ã –Ω–∞ –§–æ—Ç–æ: –Ω–∞–π—Ç–∏ –ü–æ—Ö–æ–∂–∏–µ
‚óß –ª–µ–≤–æ + Shift	–ì—Ä–∞—Ñ–∏–∫–∞ –≤–∫–ª/–≤—ã–∫–ª
‚óß + Alt	–î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –≤–∫–ª/–≤—ã–∫–ª}`,"PanelUI-menu-button": //—Ç–µ–∫—Å—Ç –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–ºÔ∏∞–≠–∫—Å–ø–µ—Ä—Ç

`‚óß –ª–µ–≤. –∫–ª–∏–∫	–º–µ–Ω—é Firefox ${Ff.ver}{\nÔ∏∞
‚óß + Shift	–∫—Ä–∞—Ç–∫–∞—è –°–ø—Ä–∞–≤–∫–∞\n}
‚óß –¥–µ—Ä–∂–∞—Ç—å	‚úï –ó–∞–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä\n` +`‚óß +Alt, ‚óâ —Ä–æ–ª–∏–∫  –û–∫–Ω–æ‚îÇ–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å

‚ó® –ø—Ä–∞–≤. –∫–ª–∏–∫	‚á≤ –°–≤–µ—Ä–Ω—É—Ç—å {Ô∏∞` /*—ç–∫—Å–ø–µ—Ä—Ç*/+ `
‚ó® + Alt		–°–≤–µ–¥–µ–Ω–∏—è –æ —Å–∏—Å—Ç–µ–º–µ}
√ò —Ä–æ–ª–∏–∫ ‚Üë	‚§æ –í–µ—Ä–Ω—É—Ç—å –≤–∫–ª–∞–¥–∫—É`,"viewHistorySidebar":
`
‚óâ + Shift		–ó–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫–∏ —Å–ª–µ–≤–∞
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ +Alt	–ó–∞–∫—Ä—ã—Ç—å —Å–ø—Ä–∞–≤–∞`,"tabs-newtab-button":
`
‚ó® –ø—Ä–∞–≤. –∫–ª–∏–∫	–í–µ—Ä–Ω—É—Ç—å –≤–∫–ª–∞–¥–∫—É
‚óß –ª–µ–≤.+ Alt  –û—Å—Ç–∞–≤–∏—Ç—å 1 —Ç–µ–∫—É—â—É—é`,"identity-box": //debug ‚òë –∫–æ–º–∞–Ω–¥—ã|–¥–µ–π—Å—Ç–≤–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å

`–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫	 –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å –≤ –±—É—Ñ–µ—Ä
‚óâ, –ö–ª–∏–∫ + Alt	 –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏ {Ô∏∞\n
‚óß –ª–µ–≤–æ + Shift	 –ú–µ–¥–∏–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ}
√ò –∫–æ–ª—ë—Å–∏–∫–æ ¬±	 –Ø—Ä–∫–æ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü `,"favdirs-button": //–±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç–∞: debug –í–∫–ª

`–õ–µ–≤—ã–π –∫–ª–∏–∫	‚òÖ –ó–∞–∫–ª–∞–¥–∫–∏\n‚óß + Alt		–î–æ–º–∞—à–Ω—è—è –ø–∞–ø–∫–∞
–ü—Ä–∞–≤—ã–π		‚ü≥ –ò—Å—Ç–æ—Ä–∏—è\n‚ó® + Alt		–ü–∞–ø–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏\n
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ	‚¨áÔ∏é –ó–∞–≥—Ä—É–∑–∫–∏
‚óâ —Ä–æ–ª–∏–∫ +Alt	UserChromeFiles`,"QuickToggle": //‚ó® + Alt –ø–æ—Å–ª.–∑–∞–∫–ª–∞–¥–∫–∞ –º–µ–Ω—é

`–ª–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞ ‚óß –º—ã—à–∏ ¬´–ñ—É—Ä–Ω–∞–ª¬ª\n
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ	–º–µ–Ω—é ¬´–î–µ–π—Å—Ç–≤–∏—è¬ª
‚ó® –ø—Ä–∞–≤–∞—è	–ë—ã—Å—Ç—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚ó® –¥–µ—Ä–∂–∞—Ç—å	–ü–∏–ø–µ—Ç–∫–∞ —Ü–≤–µ—Ç–∞, –ª–∏–Ω–∑–∞\n
‚óß –ª–µ–≤. + Alt	–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚óß –¥–µ—Ä–∂–∞—Ç—å	–ù–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ (${Ff.Ctr()}T){Ô∏∞\n
√ò –†–æ–ª–∏–∫ ¬±	–º–∞—Å—à—Ç–∞–± –°—Ç—Ä–∞–Ω–∏—Ü—ã
‚óß + Shift		–º–∞—Å—à—Ç–∞–± –¢–µ–∫—Å—Ç / –í—Å—ë}`,"ReaderView":

`–ö–ª–∏–∫ –º—ã—à–∏	–ß—Ç–µ–Ω–∏–µ –≤ ReaderView
–ö–æ–ª—ë—Å–∏–∫–æ	–ü—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º —á—Ç–µ–Ω–∏—è\n`,"reader-mode-button":
`
–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫	–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
Alt + R		–í—ã–±–æ—Ä —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã\n
–ö—Ä—É—Ç–∏—Ç—å ¬±	–Ø—Ä–∫–æ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü `,"print-button":

`–†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (${Ff.Ctr()}P)\n
–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫	–±—ã—Å—Ç—Ä–∞—è –ü–µ—á–∞—Ç—å
‚óâ —Ä–æ–ª–∏–∫ —Ä–µ–∂–∏–º –ü—Ä–æ—Å—Ç–æ–π|–≠–∫—Å–ø–µ—Ä—Ç
‚óß –¥–µ—Ä–∂–∞—Ç—å	–∫—Ä–∞—Ç–∫–∞—è –°–ø—Ä–∞–≤–∫–∞`,"reload-button":

`–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫	–û–±–Ω–æ–≤–∏—Ç—å –±–µ–∑ –∫—ç—à–∞\n‚óß –¥–µ—Ä–∂–∞—Ç—å	–û–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë`,"tracking-protection-icon-container":
`
–Ω–∞–∂–∞—Ç–∏–µ –º—ã—à–∏	–°–≤–µ–¥–µ–Ω–∏—è –æ –∑–∞—â–∏—Ç–µ —Å–∞–π—Ç–∞
‚ó® –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫	–õ–æ–≥–∏–Ω—ã –∏ –ü–∞—Ä–æ–ª–∏
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ		–¥–∏—Å–ø–µ—Ç—á–µ—Ä –ó–∞–¥–∞—á {Ô∏∞\n
‚óß –ª–µ–≤. –¥–µ—Ä–∂–∞—Ç—å	‚áÜ Web-—à—Ä–∏—Ñ—Ç—ã
‚óß –ª–µ–≤ + Shift		ServiceWorkers}`,"wheel-stop":

`–ö–æ–ª—ë—Å–∏–∫–æ:	–ü—Ä–µ—Ä–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è {Ô∏∞
‚ó® –ø.–¥–µ—Ä–∂–∞—Ç—å	–ê–Ω—Ç–∏–∑–∞–ø—Ä–µ—Ç ‚áÜ –ë–µ–∑ –ø—Ä–æ–∫—Å–∏}\n`,"titlebar-button.titlebar-close": //–∫—Ä–æ–º–µ Windows

`–ó–∞–∫—Ä—ã—Ç—å Firefox ${Ff.ver}\n
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ	–≤–µ—Ä–Ω—É—Ç—å –≤–∫–ª–∞–¥–∫—É
‚óß –¥–µ—Ä–∂–∞—Ç—å	–∫—Ä–∞—Ç–∫–∞—è –°–ø—Ä–∞–≤–∫–∞\n‚ó® –ø—Ä. –∫–ª–∏–∫	‚á≤ –°–≤–µ—Ä–Ω—É—Ç—å`,"Attributes-Inspector":

`‚óß –ª–µ–≤. –∫–ª–∏–∫	–ê—Ç—Ä–∏–±—É—Ç-–ò–Ω—Å–ø–µ–∫—Ç–æ—Ä
‚óâ –∫–æ–ª—ë—Å–∏–∫–æ	–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±—Ä–∞—É–∑–µ—Ä–∞`,"@": //texts

`–û—á–∏—Å—Ç–∏—Ç—å –ø–∞–Ω–µ–ª—å –∫–æ–ª—ë—Å–∏–∫–æ–º –º—ã—à–∏|–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–∞–π—Ç—ã —á–µ—Ä–µ–∑ –ê–Ω—Ç–∏–ó–∞–ø—Ä–µ—Ç|‚òÄ –Ø—Ä–∫–æ—Å—Ç—å —Å–∞–π—Ç–æ–≤ |üíæ –∫—ç—à, –¥–∞–Ω–Ω—ã–µ —Å–∞–π—Ç–æ–≤, –∫—É–∫–∏ –∑–∞–Ω–∏–º–∞—é—Ç |–ó–∞—Ö–≤–∞—Ç —Ü–≤–µ—Ç–∞ –≤ –ë—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞. –ö—É—Ä—Å–æ—Ä: —Å–¥–≤–∏–≥ –Ω–∞ 1 —Ç–æ—á–∫—É|‚ö°Ô∏è –ó–∞–ø—Ä–µ—â–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ª–æ–≥–∏–Ω—ã –∏ –ø–∞—Ä–æ–ª–∏|–û–ø—Ü–∏–∏ ‚ó® –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫: –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é, ‚ü≥ –û–±–Ω–æ–≤–∏—Ç—å ‚ÜØ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫|–î–æ–ª–≥–∏–π –∫–ª–∏–∫ –≤ —Å—Ç—Ä–æ–∫–µ –º–µ–Ω—é: –ü—Ä–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é ‚îÇ –ö–æ–ª—ë—Å–∏–∫–æ: –°–µ—Ä–≤–∏—Å—ã|–û—à–∏–±–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ |‚ÜØ –ù–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–µ—â–µ–Ω–∏–π|‚ÜØ –£–¥–∞–ª—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–µ—â–µ–Ω–∏–π, –∑–∞–∫—Ä—ã–≤–∞—è –±—Ä–∞—É–∑–µ—Ä|–ø–µ—Ä–∏–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –º–µ–Ω—è–µ—Ç—Å—è –≤ –º–µ–Ω—é –∫–Ω–æ–ø–∫–∏ ¬´–ñ—É—Ä–Ω–∞–ª¬ª|SingleFile (Alt+Ctrl+S)\n–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–∞–π—Ç –≤ –µ–¥–∏–Ω—ã–π Html|Video DownloadHelper\n–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º–æ–≥–æ –≤–∏–¥–µ–æ|\n\n‚ó® –ø—Ä. –∫–ª–∏–∫	–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ UCF\n‚ó® –¥–µ—Ä–∂–∞—Ç—å	–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å, —É–¥–∞–ª–∏–≤ –∫—ç—à\nAlt + x		–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç User.js|\n‚ó® –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫: –ë–µ–∑ –∑–∞–ø—Ä–æ—Å–∞|zoompage-we_dw-dev-|_531906d3-e22f-4a6c-a102-8057b88a1a63_-|_b9db16a4-6edc-47ec-a1f4-b86292ed211d_-`}; init();

Menu = [{ //–∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
		lab: "—ç–∫—Å–ø–æ—Ä—Ç —Å–∞–π—Ç–∞ –≤ –µ–¥–∏–Ω—ã–π HTML",
		inf: "–∏—Å–ø–æ–ª—å–∑—É—è SingleHTML.jsm\n–∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ SingleFile",
		cmd(){ ucf.HTML()},
		img: "chrome://devtools/skin/images/globe.svg"
	},{
		lab: "–ø–∞–ø–∫–∞ –ó–∞–≥—Ä—É–∑–∫–∏",
		cmd(){ Mouse[B[0]][1]()},
		img: "chrome://devtools/skin/images/folder.svg"
	},null,{
		lab: "–í–µ—Ä–Ω—É—Ç—å –≤–∫–ª–∞–¥–∫—É",
		cmd(event){
			event.target.ownerGlobal.undoCloseTab()},
		img: "chrome://devtools/skin/images/reload.svg"
	},{
		lab: "–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏",
		cmd(){
			with (gBrowser) selectAllTabs(),reloadMultiSelectedTabs(),clearMultiSelectedTabs()},
	},[{ //–ø–æ–¥–º–µ–Ω—é
		lab: "about:config"
	},{
		lab: "–°–≤–µ–¥–µ–Ω–∏—è –æ –±—Ä–∞—É–∑–µ—Ä–µ",
		cmd(){
			switchTab('about:support')},
		img: "resource://gre-resources/password.svg"
	},{
		lab: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä–∞",
		cmd(){
			switchTab('about:profiling')},
		img: "chrome://devtools/skin/images/settings.svg"
	},{
		lab: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ UCF",
		cmd(){
			openDial()},
	}],null,{
		lab: "–ö—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞",
		cmd(){Help()},
		img: "chrome://devtools/skin/images/help.svg"
}],
Keys = { //–ø–µ—Ä–µ—Ö–≤–∞—Ç-–∫–ª–∞–≤–∏—à KeyA[_mod][_OS](e,t){–∫–æ–¥} –∏ KeyB: "KeyA"
	KeyX_1(e,t) {userjs(e)}, // Alt+X –∑–∞–ø—É—Å–∫ –≤–Ω–µ—à–Ω–µ–≥–æ JS-–∫–æ–¥–∞
	KeyS_6() {saveSelToTxt()}, /* Ctrl+Shift+S */ KeyS_15: "KeyS_6",
	KeyS_1(e,t) {ucf.HTML()}, //Alt+S | e: Event, t: gBrowser.selectedTab
/*
	mod = e.metaKey*8 + e.ctrlKey*4 + e.shiftKey*2 + e.altKey
	mod + I –≤ –∫–æ–Ω—Ü–µ: —Ç–æ–ª—å–∫–æ –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞, ¬´i¬ª –∫—Ä–æ–º–µ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞
	1—è –±—É–∫–≤–∞ —Å—Ç—Ä–æ—á–Ω–∞—è: –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏—è, –∑–∞–ø—Ä–µ—Ç preventDefault
	–æ—Ç–¥–µ–ª—è—Ç—å ¬´_¬ª –æ—Ç –∫–æ–¥–∞, –µ—Å–ª–∏ –µ—Å—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∏/–∏–ª–∏ ¬´iI¬ª-—Ñ–ª–∞–≥
	—Ç–æ–ª—å–∫–æ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π OS: KeyA_1i_win(e,t){‚Ä¶ Alt+A –¥–ª—è –≤–∏–Ω–¥—ã */
},
Mouse = { //–∫–ª–∏–∫–∏ Meta*64 Ctrl*32 –®–∏—Ñ—Ç*16 Alt*8 (Wh ? 2 : But*128) long*1
	"urlbar-input": {
		2(trg, forward){trg.value = ""} //–æ—á–∏—Å—Ç–∏—Ç—å
	},
	"tabbrowser-tabs": { //<> –≤–∫–ª–∞–¥–∫–∏ –∫–æ–ª—ë—Å–∏–∫–æ–º
		8(){},16(){},64(){}, //–≤—ã–±–æ—Ä
		2(trg,forward){
			gBrowser.tabContainer.advanceSelectedTab(forward ? -1 : 1,true);
		},
		128(btn){ //–°–ú
			gBrowser.removeTab(TabAct(btn))}, // –≤–∫–ª–∞–¥–∫–∞ –ø–æ–¥ –º—ã—à—å—é
		136(btn){TabsDel(1, TabAct(btn))}, // –°–ú + Alt –∑–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫–∏ —Å–ø—Ä–∞–≤–∞
		144(btn){TabsDel(0, TabAct(btn))} // –°–ú + Shift ‚Ä¶ —Å–ª–µ–≤–∞
	},
	"stop-button": {
		128(){ //–°
			for (var i = 0; i < gBrowser.tabs.length; i++) gBrowser.getBrowserAtIndex(i).stop() },
		257(){ucf.switchProxy()}
	},
	"star-button-box": {
		1(){translate()}, //–¥–µ—Ä–∂–∞—Ç—å
		8(){ //R + Alt
			window.PlacesCommandHook.showPlacesOrganizer("BookmarksToolbar") }, //–±–∏–±–ª–∏–æ—Ç–µ–∫–∞
		128(){switchTab(FavItem()) },
		129(){ //–¥–°
			switchTab(FavItem(false))	},
		256(){toFav()}
	},
	"appMenu-print-button2": { //–º–µ–Ω—é –ü–µ—á–∞—Ç—å‚Ä¶
		1(){Help()}, 128(btn){Expert()},
		256(){Mouse[B[9]][256]()}
	},
	"pageAction-urlbar-_2495d258-41e7-4cd5-bc7d-ac15981f064e_": { //ReaderView
		2(trg,forward){bright(trg,forward,5)}, //—è—Ä–∫–æ—Å—Ç—å –ø–æ wheel ¬±
		128(btn){
			btn.ownerDocument.getElementById("key_toggleReaderMode").doCommand() //—à—Ç–∞—Ç–Ω—ã–π –†–µ–∂–∏–º —á—Ç–µ–Ω–∏—è
		},
		256(btn){Mouse[B[8]][256](btn)}
	},
	[B[10]]: { //reload
		1(){ //–¥
			with (gBrowser) selectAllTabs(),reloadMultiSelectedTabs(),clearMultiSelectedTabs();
		},
		128(){for (var i = 0; i < gBrowser.tabs.length; i++) gBrowser.getBrowserAtIndex(i).stop()}, //–°–ú
		256(){BrowserReloadSkipCache()}, //R
		257(){ucf.switchProxy()} //–¥R
	},
	[B[3]]: { //newtab
		8(){gBrowser.removeAllTabsBut(gBrowser.selectedTab)},
		256(btn){btn.ownerGlobal.undoCloseTab()}
	},
	[B[9]]: { //print
		1(){Help()}, //–¥
		128(){Expert()},
		256(){document.getElementById("menu_print").doCommand()} //R
	},
	[B[0]]: {mousedownTarget: true, //–Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏—è –¥–∞–ª—å—à–µ
		1(){ //–¥
			Downloads.getSystemDownloadsDirectory().then(path => FileUtils.File(path).launch(),Cu.reportError)},
		8(){ //+Alt
			var p = "browser.download.improvements_to_download_panel", n = ucf.pref(p);
			ucf.pref(p, !n);
			ucf.toStatus(`–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ ${n ? "‚àö —Ä–∞–∑—Ä–µ—à" : "‚úò –∑–∞–ø—Ä–µ—â"}–µ–Ω–æ`,3e3);
		},
		16(){ //+Shift //–Æ–∑–µ—Ä–ê–≥–µ–Ω—Ç –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é
			var n = ucf.pref(Ff.i) == 2; ucf.pref(Ff.i, n ? 1 : 2);
			ucf.mode_skin(); BrowserReload();
			ucf.toStatus(`–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ${n ? "‚àö —Ä–∞–∑—Ä–µ—à" : "‚úò –∑–∞–ø—Ä–µ—â"}–µ–Ω–æ`,3e3);
		},
		128(){Ff.Exp() //—Ä–µ–∂–∏–º –ü—Ä–æ—Å—Ç–æ–π/–≠–∫—Å–ø–µ—Ä—Ç: —Ä–∞–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
			? saveSelToTxt() : //—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å|–≤—ã–¥–µ–ª–µ–Ω. –∫–∞–∫ .txt
			Downloads.getSystemDownloadsDirectory().then(path => FileUtils.File(path).launch(),Cu.reportError)
		},
		256(){ucf.HTML()} //web
	},
	[B[1]]: {mousedownTarget: true, //PanelUI
		1(btn){goQuitApplication(btn)}, //–¥
		16(){Help()}, //L+Shift
		8(){windowState != STATE_MAXIMIZED ? maximize() : restore()}, //L+Alt
		128(){windowState != STATE_MAXIMIZED ? maximize() : restore()},
		129(){BrowserFullScreen()}, //–¥–°
		136(){this[129]()}, //–°+Alt
		2(trg,forward){ // –∫—Ä—É—Ç–∏—Ç—å +–ó–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É -–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
			forward ? trg.ownerGlobal.undoCloseTab() : trg.ownerGlobal.BrowserCloseTabOrWindow() },
		256(){minimize()},
		264(){switchTab('about:support')}, //R+Alt
		272(btn){btn.ownerGlobal.PlacesCommandHook.showPlacesOrganizer("History")} //R+Shift
	},
	[B[8]]: { //‚ûø
		2(trg,forward){bright(trg,forward,5)}, //—è—Ä–∫–æ—Å—Ç—å
		256(btn){ // MobileView
			btn.ownerDocument.getElementById("key_responsiveDesignMode").doCommand(); //–ø—É–Ω–∫—Ç –º–µ–Ω—é —Å HotKey
			if (gBrowser.selectedBrowser.browsingContext.inRDMPane) BrowserReload();}
	},
	[B[4]]: { //–∑–∞–º–æ–∫
		8(){		openProxyWin()}, //+Alt
		128(){	this[8]()},
		16(btn){ //+Shift
			BrowserPageInfo(btn,"mediaTab") //securityTab feed‚Ä¶ perm‚Ä¶
		},
		2(trg,forward){bright(trg,forward,5)}, //—è—Ä–∫–æ—Å—Ç—å
		10(trg,forward){bright(trg,forward)},
		256(){gClipboard.write(gURLBar.value);
			ucf.flash(0,0,'rgba(240,176,0,0.5)',300,"–≤ –±—É—Ñ–µ—Ä–µ: "+ gURLBar.value.slice(0,80));}
	},
	[B[11]]: { //—â–∏—Ç
		1(){Mouse[B[6]][136]()}, //–¥ –®—Ä–∏—Ñ—Ç—ã
		2(trg,forward){bright(trg,forward)},
		256(btn){ //R
			var logins = btn.ownerDocument.getElementById("ucf-logins-sitedata");
			logins ? logins.click() : switchTab('about:logins');
		},
		16(){switchTab()}, //+Shift
		128(){switchTab('about:performance')} //–°
	},
	[B[5]]: { //favdirs CustomizableUI –≤ —Å–∫—Ä–∏–ø—Ç–µ
		0(btn){btn.ownerGlobal.SidebarUI.toggle("viewBookmarksSidebar")},
		256(btn){btn.ownerGlobal.SidebarUI.toggle(B[2])},
		8(){ucf.dirsvcget("Home")}, //+Alt
		128(btn){
			btn.ownerGlobal.PlacesCommandHook.showPlacesOrganizer("Downloads") },
		136(){ //C+Alt
			ucf.dirsvcget("UChrm","user_chrome_files")},
		264(){ //R+Alt
			ucf.dirsvcget("GreD")}
	},
	"unified-extensions-button": {mousedownTarget: true,
		1(){Expert()}, //–¥
		256(){openDial()},
		257(){Mouse[B[14]][257]()}
	},
	[B[14]]: {mousedownTarget: true, //AttrView
		256(){openDial()}, //UCFprefs
		257(){ //–¥R Clean Cache
			var cancelQuit = Cc["@mozilla.org/supports-PRBool;1"].createInstance(Ci.nsISupportsPRBool);
			Services.obs.notifyObservers(cancelQuit,"quit-application-requested","restart");
			if (cancelQuit.data) return false;
			Services.appinfo.invalidateCachesOnRestart();
			var restart = Services.startup;
			restart.quit(restart.eAttemptQuit | restart.eRestart);
		},
		128(){ //C —É–¥.–æ—Ç–ª–∞–¥–∫–∞
			var chr = "devtools.chrome.enabled",rem = "devtools.debugger.remote-enabled";
			if (!ucf.pref(chr) || !ucf.pref(rem)) {
				ucf.pref(chr,true); ucf.pref(rem,true);
			}
			var {BrowserToolboxLauncher} = ChromeUtils.import("resource://devtools/client/framework/browser-toolbox/Launcher.jsm");
			BrowserToolboxLauncher.init();
		}
	},
	[B[13]]: { //title-close
		1(){Help()},
		128(btn){	btn.ownerGlobal.undoCloseTab()},
		256(){minimize()}
	},
	[B[6]]: {mousedownTarget: true,
		0(btn){ //L
			if (btn.id == B[6]) {
				var bar = document.getElementById("ucf-additional-vertical-bar");
				if (bar) window.setToolbarVisibility(bar,document.getElementById("sidebar-box").hidden);
				window.SidebarUI.toggle(B[2]);
			} else if (btn.className == "menu-iconic") {
				Node.hidePopup();
				ucf.about_config(btn.pref.pref); //go –ø–∞—Ä–∞–º–µ—Ç—Ä about:config
			} else ucf.mode_skin();
		},
		2(trg,forward){zoom(forward)}, //wheel
		1(btn){ //–¥
			if (btn.id == B[6])
				switchTab("about:newtab");},
		8(){switchTab('chrome://browser/content/places/places.xhtml')}, //L+Alt
		264(){ //R+Alt
			switchTab(FavItem(false))},
		16(btn){if (btn.id == B[6]) zoom(0,1)}, //L+Shift
		128(btn, trg){ //C Menu-1
			if (btn.id == B[6] || trg)
				btn.menupopup.openPopup(trg ||= btn, "before_start");
		},
		129(btn){userjs(btn,"")}, //–¥C –∫–æ–Ω—Å–æ–ª—å
		256(btn){ //about Menu
			if (btn.id != B[6]) return;
			setTimeout(()=> {
				if (btn.config.state != "open")
				  btn.config.openPopup(btn, "before_start")
				else
				  btn.config.hidePopup();
			},50);
		},
		257(btn){ //–¥R
			if (btn.id != B[6]) return; //–ª–∏–Ω–∑–∞
			var url = `resource://devtools/shared/${parseInt(Ff.ver) > 95 ? "loader/" : ""}Loader.`;
			try {var exp = ChromeUtils.importESModule(url + "sys.mjs");} catch {exp = ChromeUtils.import(url + "jsm");}
			var obj = exp.require("devtools/client/menus").menuitems.find(menuitem => menuitem.id == "menu_eyedropper");
			(test = obj.oncommand.bind(null, {target:btn}))();
			ucf.flash(0,0,'rgba(100,0,225,0.1)',500, T[4]);
		},
		136(){ //–°+Alt
			var n = "browser.display.use_document_fonts",f = ucf.pref(n) ? 0 : 1;
			ucf.pref(n,f); zoom(0,0,0,(f > 0) ? " + Web-—à—Ä–∏—Ñ—Ç—ã" : ""); BrowserReload();}
	},
	[B[16]]: {2(trg,forward){zoom(forward)}}, //zoompage
	[B[17]]: {2(){Mouse[B[16]][2]()}},
}; var M = Object.keys(Mouse), Mus = {}; M.forEach((k) =>{Mus["#"+ k] = Mus["."+ k] = Mouse[k]});

Setup = [{ // –±—ã—Å—Ç—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
	pref: ["dom.disable_open_during_load", "–í—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞"], Def3el: 2, Yellow: true,
	keys: [[true, "–ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"], [false, "–†–∞–∑—Ä–µ—à–∏—Ç—å"]],
},{ // pref,lab,key,hint,[val,str],code | keys:val,lab,dat,+hint,code | icon:–∑–Ω–∞—á–æ–∫
	pref: ["javascript.enabled", "–í—ã–ø–æ–ª–Ω—è—Ç—å —Å–∫—Ä–∏–ø—Ç—ã Java",,"–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∞–π—Ç–æ–≤, —Ä–µ–∫–ª–∞–º—ã\n—Ç–∞–∫–∂–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à"], Def3el: true, refresh: true,
	keys: [[true, "–î–∞"], [false, "–ù–µ—Ç"]]
},{
	pref: ["browser.safebrowsing.downloads.remote.block_dangerous", "–û–ø–∞—Å–Ω—ã–µ —Ñ–∞–π–ª—ã, —Å–∞–π—Ç—ã",,"browser.safebrowsing.downloads.remote.block_dangerous_host"], Def3el: true, Yellow: false,
	keys: [[true, "–ó–∞–ø—Ä–µ—Ç",,,`ucf.pref('browser.safebrowsing.downloads.remote.block_dangerous_host',true)`], [false, "–û—Ç–∫—Ä—ã—Ç—å",,,`ucf.pref('browser.safebrowsing.downloads.remote.block_dangerous_host',false)`]]
},{
	pref: ["ucf.savedirs", "–ó–∞–≥—Ä—É–∑–∫–∏",,'–ü—É—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –°—Ç—Ä–∞–Ω–∏—Ü –∏ –ì—Ä–∞—Ñ–∏–∫–∏\n–°–∏–Ω—Ç–∞–∫—Å–∏—Å ¬´_Html/subdir|_Pics/subdir¬ª\nsubdir: –ø—É—Å—Ç–æ | 0 –∑–∞–≥–æ–ª–æ–≤–æ–∫ | 1 –¥–æ–º–µ–Ω',
		["", "–≤—Å—ë –≤ –æ–±—â–µ–π –ø–∞–ø–∫–µ"]], Def3el: "_–°–∞–π—Ç—ã||_–§–æ—Ç–æ|0", Blue: "_Web|1|_Images|0", Gray: "",
	keys: [ // —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Html/Pics. [–ó–∞–≥—Ä—É–∑–∫–∏]/"_Html/subdir|_Pics/subdir" subdir: –ø—É—Å—Ç–æ | 0 –∑–∞–≥–æ–ª–æ–≤–æ–∫ | 1 –¥–æ–º–µ–Ω
		["_–°–∞–π—Ç—ã||_–§–æ—Ç–æ|0", "_–°–∞–π—Ç—ã|_–§–æ—Ç–æ/–∏–º—è‚Ä¶"],
		["_Web||_Photo|0", "_Web|_Photo/–∏–º—è"],
		["_Web|1|_Pics|1", "_Web/—Å–∞–π—Ç|_Pics/‚Ä¶"],
		["_Web|0|_Pics|", "_Web/–∏–º—è|_Pics"],
		["_Web|1|_Images|0", "_Web/—Å–∞–π—Ç, _Images/–∏–º—è"], //–æ—Ç–∫—Ä—ã—Ç—å –æ–ø—Ü–∏—é about:config:
		["–°–∞–π—Ç||–§–æ—Ç–æ|", "–≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ‚Ä¶",,"–∫–ª—é—á –≤ about:config",`ucf.about_config('ucf.savedirs')`]]
},null,{
	pref: [I[3], "–ü—Ä–æ–∫—Å–∏ (VPN)", "–ø", I[2] +"\n\n–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫"],
	Def3el: "localhost", Yellow: I[1], Gray: "", refresh: true,
	keys: [ //—Ñ–æ–Ω –∫–Ω–æ–ø–∫–∏ –ú–µ–Ω—é: —Å–µ—Ä—ã–π, –≥–æ–ª—É–±–æ–π, –∫—Ä–∞—Å–Ω—ã–π, –∂—ë–ª—Ç—ã–π, –∑–µ–ª—ë–Ω—ã–π
		["localhost", "—Å–∏—Å—Ç–µ–º–Ω—ã–π", "0",, "ucf.pref(I[2], 5)"],
		[I[1], "–ê–Ω—Ç–∏–ó–∞–ø—Ä–µ—Ç", "2", "–ù–∞–¥—ë–∂–Ω—ã–π –¥–æ—Å—Ç—É–ø –Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∞–π—Ç—ã\n¬´–†–µ–∂–∏–º –ø—Ä–æ–∫—Å–∏¬ª –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ 2",
			"ucf.pref(I[2], 2)"],
		["127.0.0.1", "Tor –∏–ª–∏ Opera", "1", "–ù–µ–æ–±—Ö–æ–¥–∏–º —Å–µ—Ä–≤–∏—Å tor –∏–ª–∏ opera-proxy",
			"ucf.pref(I[2], 1)"],
		[ucf.pref(["user.pacfile", "file:///etc/proxy.pac"]), "user .pac —Ñ–∞–π–ª", "4", "about:config pacfile"]] //–Ω—É–∂–µ–Ω –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ pac-—Ñ–∞–π–ª–∞
},{
	pref: [I[2], "–†–µ–∂–∏–º –ø—Ä–æ–∫—Å–∏", "—Ä"], Gray: 0, Def3el: 5, Blue: 4, Yellow: 2, refresh: true,
	keys: [[5, "—Å–∏—Å—Ç–µ–º–Ω—ã–π", "5"],
		[2, "–ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞", "2", "about:config pacfile"],
		[1, "–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞", "1", "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è "+ I[3]],
		[4, "–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ", "4"],
		[0, "–ë–µ–∑ –ø—Ä–æ–∫—Å–∏", "0", I[5]]]
},{
	pref: ["network.trr.mode", "DNS –ø–æ–≤–µ—Ä—Ö HttpS",, "–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ DNS-—Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è\n–∑–∞—â–∏—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"], Def3el: 0, Yellow: 2, Gray: 5, refresh: true,
	keys: [
		[0, I[5], "0"], [1, "–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏", "1", "–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DNS –∏–ª–∏ DoH, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –±—ã—Å—Ç—Ä–µ–µ"], [2, "DoH, –∑–∞—Ç–µ–º DNS", "2"], [3, "—Ç–æ–ª—å–∫–æ DoH", "3"], [4, "DNS –∏ DoH", "4"], [5, "–æ—Ç–∫–ª—é—á–∏—Ç—å DoH", "5"]]
},{
	pref: ["network.cookie.cookieBehavior", "–ü–æ–ª—É—á–∞—Ç—å –∫—É–∫–∏",,"–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å–µ—â—ë–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤"], Def3el: 3, Yellow: 0, Gray: 4,
	keys: [[0, "—Å–æ –≤—Å–µ—Ö —Å–∞–π—Ç–æ–≤"], [3, "–ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ —Å–∞–π—Ç—ã"], [4, "–∫—Ä–æ–º–µ —Ç—Ä–µ–∫–µ—Ä–æ–≤"], [1, "–∫—Ä–æ–º–µ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö"], [2, "–Ω–∏–∫–æ–≥–¥–∞"]]
},null,{
	pref: ["browser.display.use_document_fonts", "–ó–∞–≥—Ä—É–∂–∞—Ç—å —à—Ä–∏—Ñ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü"], Def3el: 1, Gray: 0, refresh: true,
	keys: [[1, "–î–∞"], [0, "–ù–µ—Ç"]]
},{
	pref: ["font.name.sans-serif.x-cyrillic", "–®—Ä–∏—Ñ—Ç –±–µ–∑ –∑–∞—Å–µ—á–µ–∫ ",,"–¢–∞–∫–∂–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏\n–°–∏—Å—Ç–µ–º–Ω—ã–π: –∑–∞–≥—Ä—É–∑–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞"], Def3el: "", Yellow: "Roboto", Gray: "Arial", keys: sans
},{
	pref: ["font.name.serif.x-cyrillic", "–®—Ä–∏—Ñ—Ç —Å –∑–∞—Å–µ—á–∫–∞–º–∏"], Def3el: "", Yellow: "Arial", keys: serif
},{
	pref: ["gfx.webrender.force-disabled", "–£—Å–∫–æ—Ä—è—Ç—å –æ—Ç—Ä–∏—Å–æ–≤–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü", ,"gfx.webrender.compositor.force-enabled\ngfx.webrender.all\n\n–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–æ–π.\n–æ—Ç–∫–ª—é—á–∏—Ç–µ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –≥—Ä–∞—Ñ–∏–∫–æ–π"],
	Def3el: false, Yellow: true, Gray: undefined, restart: true, keys: [
	[true, "–ù–µ—Ç",,,`[['gfx.webrender.compositor.force-enabled', false], ['gfx.webrender.all', false]].map((a) =>{ucf.pref(...a)})`],
	[false, "–î–∞",,,`[['gfx.webrender.compositor.force-enabled', true], ['gfx.webrender.all', true]].map((a) =>{ucf.pref(...a)})`]]
},null,{
	pref: ["media.autoplay.default", "–ê–≤—Ç–æ-play –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ"], Def3el: 0, Yellow: 2, Gray: 5, refresh: true,
	keys: [
		[0, "–†–∞–∑—Ä–µ—à–∏—Ç—å", "0"], [2, "–°–ø—Ä–∞—à–∏–≤–∞—Ç—å", "2"], [1, "–ó–∞–ø—Ä–µ—Ç–∏—Ç—å", "1"], [5, "–ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å", "5"]]
},{
	pref: ["dom.storage.enabled", "–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ",, "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–æ\n–∫–æ—Ç–æ—Ä—ã–º –≤–∞—Å –º–æ–∂–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å"],
	Def3el: false, Yellow: true,
	keys: [[true, "–†–∞–∑—Ä–µ—à–∏—Ç—å"], [false, "–ó–∞–ø—Ä–µ—Ç–∏—Ç—å"]]
},{
	pref: ["privacy.resistFingerprinting", "–ò–∑–æ–ª—è—Ü–∏—è Firstparty-Fingerprint", ,"privacy.firstparty.isolate\n\n–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–∞–∫–∂–µ\n–∑–∞–ø—Ä–µ—â–∞–µ—Ç –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞"], Def3el: false,
	keys: [[true, "–î–∞", , "–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª–µ–∂–∫–∏",`ucf.pref('privacy.firstparty.isolate', true)`], [false, "–ù–µ—Ç", , "–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª–µ–∂–∫–∏",`ucf.pref('privacy.firstparty.isolate', false)`]]
},(()=>{
if (parseInt(Ff.ver) > 114) return { //–Ω–æ–≤—ã–π FF
	pref: ["browser.translations.enable", "–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ —Å–∞–π—Ç–æ–≤"], Def3el: true, Gray: false, refresh: true,
	keys: [[true, "–î–∞"], [false, "–û—Ç–∫–ª",,,`ucf.mode_skin('–ü–µ—Ä–µ–≤–æ–¥ –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è –Ω–æ–≤—ã—Ö –≤–∫–ª–∞–¥–æ–∫')`]]
	}; else return {
	pref: ["media.peerconnection.enabled", "WebRTC –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π IP"], Def3el: false,
	keys: [[true, "–í—ã–¥–∞—Ç—å"], [false, "–°–∫—Ä—ã—Ç—å"]]
	}
})(),null,{
	pref: ["network.http.sendRefererHeader", "Referer: –¥–ª—è —á–µ–≥–æ"], Def3el: 2, Yellow: 1,
	keys: [[0, "–ù–∏ –¥–ª—è —á–µ–≥–æ", "0"], [1, "–¢–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏", "1"], [2, "–°—Å—ã–ª–∫–∏, –≥—Ä–∞—Ñ–∏–∫–∞", "2"]]
},{
	pref: ["browser.cache.disk.capacity", "–ö—ç—à –±—Ä–∞—É–∑–µ—Ä–∞",,"\ncache.memory.max_entry_size:\n–î–∏—Å–∫ –∏ –ø–∞–º—è—Ç—å: 5120\n—Ç–æ–ª—å–∫–æ –ü–∞–º—è—Ç—å: -1"], Def3el: 1048576, Yellow: 0, Gray: 256e3,
	keys: [
	[256e3, I[5]],
	[1048576, "–î–∏—Å–∫ –∏ –ü–∞–º—è—Ç—å",,,`[[I[7], true], [I[8], true], ['browser.cache.memory.max_entry_size', 5120]].map((a) =>{ucf.pref(...a)})`],
	[0, "—Ç–æ–ª—å–∫–æ –ü–∞–º—è—Ç—å",,,`[[I[7], true], [I[8], false], ['browser.cache.memory.max_entry_size', -1]].map((a) =>{ucf.pref(...a)})`],
	[2097152, "—Ç–æ–ª—å–∫–æ –î–∏—Å–∫",,,`[[I[7], false], [I[8], true]].map((a) =>{ucf.pref(...a)})`]]
},{
	pref: ["browser.sessionstore.interval", "–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π",,"–ë—Ä–∞—É–∑–µ—Ä —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç —Å–µ—Å—Å–∏–∏ –Ω–∞\n—Å–ª—É—á–∞–π —Å–±–æ—è, —Å–Ω–∏–∂–∞—è —Ä–µ—Å—É—Ä—Å SSD"], Gray: 15e3, Def3el: 6e4, Blue: 3e5, Yellow: 9e5,
	keys: [
	[15e3, "15 —Å–µ–∫"], [6e4, "1 –º–∏–Ω"], [3e5, "5 –º–∏–Ω"], [9e5, "15 –º–∏–Ω"], [18e5, "30 –º–∏–Ω"]]
},{
	pref: [I[4], "User Agent",,"–ò–∑–º–µ–Ω—è–µ—Ç –≤–∏–¥ —Å–∞–π—Ç–∞", [ua,"–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π"],`console.log("MENU"); console.log(trg.val)`], refresh: true, Def3el: ua,
	// Yellow: I[6] + I[6], Gray: I[6] + I[7],
	keys: [
	[ucf.uam(), "–≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ‚Ä¶",,,`console.log("VASHI");`], //ucf.about_config(I[4])
	[I[6] + "Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36", "Chrome 118 Win10"],
	[I[6] +"Windows; U; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727)", "MSIE 6.0 Windows"],
	["Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16", "Opera12 W8"],
	[I[6] +"PlayStation 4 3.11) AppleWebKit/537.73 (KHTML, like Gecko)", "Playstation 4"],
	[I[6] +"compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0; SAMSUNG; GT-I8350)", "Windows Phone"],
	[I[6] +"Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.143 YaBrowser/22.5.0.1916 Yowser/2.5 Safari/537.36","Yandex MacOS"],
	[I[6] +"compatible; Googlebot/2.1; +http://www.google.com/bot.html)", "GoogleBot"],
	[ua, I[5]]] //—à—Ç–∞—Ç–Ω—ã–π –Æ–∑–µ—Ä–ê–≥–µ–Ω—Ç
}]; I.push(Setup[Setup.length-1].keys);

Over = { //edit –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–¥ –º—ã—à—å—é
get [B[1]](){ //PanelUI delete this[‚Ä¶];
	ucf.mode_skin(); if (ucf.pref("signon.rememberSignons"))
		Services.cache2.asyncGetDiskConsumption({onNetworkCacheDiskConsumption(bytes){
			ucf.toStatus(T[3] + ucf.formatBytes(bytes),3e3) //–≤—ã–≤–æ–¥ –æ–±—ä—ë–º–∞ –∫—ç—à–∞
		}, QueryInterface: ChromeUtils.generateQI(["nsISupportsWeakReference","nsICacheStorageConsumptionObserver"])})
	else ucf.toStatus(T[5],2e3); //–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª–∏
	return tExp(B[1]);
},
get [B[3]](){ //newtab
	return GetDynamicShortcutTooltipText(B[3]) + Tag[B[3]];
},
get [B[0]](){var dw = ucf.dirsvcget("");
	if (dw) ucf.mode_skin(`${ucf.pref(Ff.i) > 1 ? "\u{26A1} –ì—Ä–∞—Ñ–∏–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞," : "üíæ –ø–∞–ø–∫–∞"} [–ó–∞–≥—Ä—É–∑–∫–∏] `+ crop(dw, 96,''));
	return GetDynamicShortcutTooltipText(B[0]) +"\n"+ tExp(B[0]);
},
get "tabbrowser-tab"(){var trg = window.event?.target; //get –∏—Å–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥
	trg.tooltipText = trg.label + Tag[B[2]];
},
get [B[10]](){ucf.mode_skin('');
	return GetDynamicShortcutTooltipText(B[10]) +"\n\n"+ Tag[B[10]] +"\n"+ tExp(B[12]);
},
get [M[2]](){return GetDynamicShortcutTooltipText(M[2]) +"\n"+ tExp(B[12]); //stop
},
get [M[0]](){ucf.toStatus(T[0],2500)}, //tab
[B[9]]: Tag[B[9]], [M[4]]: Tag[B[9]], //print
"titlebar-button titlebar-close": Tag[B[13]],
get [M[3]](){ //‚ãÜ
	var txt = `${ucf.pref("dom.disable_open_during_load") ? "–ó–∞–ø—Ä–µ—Ç" : "‚ÜØ –†–∞–∑—Ä–µ—à"}–∏—Ç—å –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞`;
	if (!ucf.pref("places.history.enabled")) txt = T[9];
	if (ucf.pref("privacy.sanitize.sanitizeOnShutdown")) txt = T[10];
	ucf.toStatus(txt,3e3);
	var hint = document.getElementById(M[3]).tooltipText;
	return hint.indexOf(T[15]) == -1 ? hint + T[15] : hint;
},
get [B[14]](){return Tag[B[14]] + T[14];},
get "identity-icon-box"(){ //custom hint
	return tooltip_x(window.event.target, tExp(B[4]) + br_val());
},
get [B[4]](){ucf.toStatus(this.br_exp(),2500); //+mode
	return tooltip_x(window.event.target, tExp(B[4]) + br_val());
},
get [B[11]](){ucf.toStatus(this.br_exp(),2500); //—â–∏—Ç
	var trg = window.event?.target; //custom hint 2
	return trg.id.endsWith("r") && trg.textContent +'\n'+ tExp(B[11]);
},
get [B[6]](){ //FavMenu
	var trg = window.event?.target;
	if (trg.id == B[6])
		zoom(0,0,0,`, ${ucf.pref("browser.tabs.loadInBackground") ? "–ù–µ –≤—ã–±–∏—Ä–∞—Ç—å" : "–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –≤"} –Ω–æ–≤—ã–µ –≤–∫–ª–∞–¥–∫–∏`)
	else if (trg.id)
			ucf.toStatus(T[6],9e3);
	try {trg.mstate = trg.config.state + trg.menupopup.state;} catch{} //QuickToggle
	if (!/open/.test(trg.mstate))
		return tExp(B[6])
	else trg.tooltipText = "";
},
get [B[8]](){ //reader
	return GetDynamicShortcutTooltipText(B[8]) +"\n"+ Tag[B[8]] + br_val();
},
get [M[5]](){ //ReaderView
	return Tag[B[7]] + Tag[B[8]] + br_val();
},
get "ucf_SessionManager"(){ucf.toStatus(T[11]);},
get "unified-extensions-button"(){return "–†–∞—Å—à–∏—Ä–µ–Ω–∏—è"+ T[14]},
get [B[16]](){ //zoompage
	return tooltip_x(window.event.target,"‚©â –†–æ–ª–∏–∫ ¬±	–ò–∑–º–µ–Ω–∏—Ç—å –º–∞—Å—à—Ç–∞–±");
}, get [B[17]](){return Over[B[16]]},
[B[18]]: T[12], [B[19]]: T[12], //SingleFile
[B[20]]: T[13], [B[21]]: T[13], //VDH
br_exp(t = T[2] + br_val()){
	return t +` ${Ff.Exp() ? "–≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π" : "–ü—Ä–æ—Å—Ç–æ–π"} —Ä–µ–∂–∏–º –∫–Ω–æ–ø–æ–∫`}
};
((obj,del,re,reos) => { //–ø–∞—Ä—Å–∏–Ω–≥ –±–ª–æ–∫–∞ –∫–ª–∞–≤–∏—à —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞–∂–∞—Ç–∏–π
	var num = -Ff.os.length - 1;
	for(var p in Keys) reos.test(p) && del.add( p.endsWith(platform) ? p.slice(0,num) : p);
	for(var p in Keys) del.has(Keys[p]) && del.add(p);
	for(var d of del) delete Keys[d]; //–µ—Å—Ç—å Key_OS ? —É–¥–∞–ª–∏—Ç—å –∏–º–µ–Ω–∞-–∫–ª–æ–Ω—ã
	for(var p in Keys) if (reos.test(p))
			Keys[p.replace(reos,'')] = Keys[p], delete Keys[p]; //—É–±—Ä–∞—Ç—å –∏–º—è –≤–∞—à–µ–π –û–° –∏–∑ —Å–≤–æ–π—Å—Ç–≤–∞
	for(var p in Keys){var func = Keys[p]; //(){‚Ä¶}, bool,num
		if (typeof func == "string") func = Keys[func]; //—Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é
		var [key,mod] = p.split("_"); mod = mod || "";
		var upper = key[0].toUpperCase(); var prevent = key[0] == upper;
		var [, m,i] = mod.match(re); m = m || 0; //modifiers bitmap
		var arr = [func,prevent, i ? i == "I" ? 0 : 1 : -1]; //textfields flag –ò–º—è_i 1 –∫—Ä–æ–º–µ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞
		var prop = prevent ? key : upper + key.slice(1); //–∏–º—è –±–µ–∑ mod
		var o = obj[prop] || (obj[prop] = Object.create(null));
		o[m] ? o[m].push(arr) : o[m] = [arr]; //–∏–º—è —Å–æ —Å—Ç—Ä–æ—á–Ω–æ–π: Skip preventDefault
	}; Keys = obj; })(Object.create(null),new Set(),/(\d+)?(i)?/i,/_(?:win|linux|macosx)$/);

var Debug = (e,id = "sidebar-box") => {
	if (prefs.getBoolPref(Ff.p +'debug',false)) return true;
	return !document.getElementById(id).hidden;
},
keydown_win = e => { //–ø–µ—Ä–µ—Ö–≤–∞—Ç –∫–ª–∞–≤–∏—à, —É—á–∏—Ç—ã–≤–∞—è –ø–æ–ª—è –≤–≤–æ–¥–∞
	if (e.repeat) return; //–≤—ã–∫–ª—é—á–∏—Ç—å
	var KB = Keys[e.code]?.[e.metaKey*8 + e.ctrlKey*4 + e.shiftKey*2 + e.altKey];
	if (KB) //–µ—Å—Ç—å HotKey
		for(var [func,p,i] of KB)
			if (i ^ docShell.isCommandEnabled("cmd_insertText"))
				p && e.preventDefault(), func(e, gBrowser.selectedTab); //–∑–∞–ø—É—Å–∫ –ø–æ —Å–æ—á–µ—Ç–∞–Ω–∏—é
	if (!Debug()) return; //–ø–æ–∫–∞–∑ –∫–ª–∞–≤–∏—à
	console.log('‚ñ† key '+ e.code + ('_'+ (e.metaKey*8 + e.ctrlKey*4 + e.shiftKey*2 + e.altKey)).replace('_0',''));
};
listener = { //–¥–µ–π—Å—Ç–≤–∏—è –º—ã—à–∏, –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
	handleEvent(e){
		if (this.skip || e.detail > 1) return;
		var trg = e.target, id = trg.id;
		if (id) Node = trg; //Parent || trg.tagName
		if (e.type == "mouseenter"){
			var hint = Over[id] || Over[(trg = trg.parentNode).id];
			if (hint) trg.tooltipText = hint; return; //–æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
		}
		var sels = this.selectors.filter(this.filter, trg); //#id
		var {length} = sels; if (!length) return;
		var wheel = e.type.startsWith("w");
		var num = e.metaKey*64 + e.ctrlKey*32 + e.shiftKey*16 + e.altKey*8 + (wheel ? 2 : e.button*128);
		var obj = Mus[
			length > 1 && sels.find(this.find,num) || sels[0]
		];
		Debug() && console.log('‚ñ† but ¬´'+ id +'¬ª key '+ num); //wheel –¥–≤–∞–∂–¥—ã
		if (wheel) return obj[num]?.(trg, e.deltaY < 0);
// mousedown
		if (e.type.startsWith("m")) {
			obj.mousedownTarget && this.stop(e);
			this.longPress = false; //+ –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –æ–±—ã—á–Ω–æ–º –∫–ª–∏–∫–µ
			if (++num in obj)
				this.mousedownTID = setTimeout(this.onLongPress, 333, trg,obj,num);
			if (e.button == 2)
				this.ctx = trg.getAttribute("context"), trg.setAttribute("context","");
			return;
		}
		obj.mousedownTarget || this.stop(e);	//click
		if (this.longPress) return this.longPress = false;
		this.mousedownTID &&= clearTimeout(this.mousedownTID);
		if (!obj[num]){
			if (e.button == 1) return;
			if (e.button){
				num = "context";
				for(var p in this.a) this.a[p] = e[p];
			} else
				num = "dispatch", this.mdt = obj.mousedownTarget;
			obj = this;
		}
		obj[num](trg); //click
	},
	find(sel){ //—É—Å–ª–æ–≤–∏—è –∑–∞–ø—É—Å–∫–∞ ?
		return Mus[sel][this] || Mus[sel][this + 1];
	},
	filter(sel){return this.closest(sel);
	},
	get selectors(){
		this.onLongPress = (trg,obj,num) => {
			this.mousedownTID = null;
			this.longPress = true;
			obj[num](trg);
		}
		delete this.selectors;
		return this.selectors = Object.keys(Mus);
	},
	get mdEvent(){
		delete this.mdEvent;
		return this.mdEvent = new MouseEvent("mousedown", {bubbles: true});
	},
	context(trg){
		this.ctx ? trg.setAttribute("context",this.ctx) : trg.removeAttribute("context");
		trg.dispatchEvent(new MouseEvent("contextmenu",this.a));
	},
	dispatch(trg){
		this.skip = true;
		this.mdt ? trg.dispatchEvent(this.mdEvent) : trg.click();
		this.skip = false;
	},
	stop: e => {
		e.preventDefault(); e.stopImmediatePropagation();
	},
	a: {__proto__: null,bubbles: true,screenX: 0,screenY: 0}
},
id = "ucf_hookExpert",events = ["click","mousedown","mouseenter","wheel"],
els = document.querySelectorAll("#navigator-toolbox,#ucf-additional-vertical-bar,#appMenu-popup,#widget-overflow-mainView");
for(var el of els) for(var type of events) el.addEventListener(type,listener,true);
window.addEventListener("keydown",keydown_win,true);
ucf_custom_script_win.unloadlisteners.push(id);
ucf_custom_script_win[id] = {destructor(){
	window.removeEventListener("keydown",keydown_win);
	for(var el of els) for(var type of events) el.removeEventListener(type,listener,true);
}};
var addDestructor = nextDestructor => { //–¥–ª—è saveSelToTxt
	var {destructor} = ucf_custom_script_win[id];
	ucf_custom_script_win[id].destructor = () => {
		try {destructor();} catch(ex){Cu.reportError(ex);}
		nextDestructor();
}};
with (document) getElementById(B[11]).removeAttribute("tooltip"),
	getElementById("nav-bar").tooltip = id; //—Ñ–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

ucf.mode_skin(); //–ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
[['ui.prefersReducedMotion',0],['browser.download.alwaysOpenPanel',false],['browser.download.autohideButton',false] //DownloadButton FIX
].forEach((p)=>ucf.pref(...p)); //lockPref –æ–ø—Ü–∏–π
var tabr = Ff.p +"opacity",url = `resource://${tabr}/`, //bright tabs
getIntPref = (p) => prefs.getIntPref(p,100),
sss = Cc["@mozilla.org/content/style-sheet-service;1"].getService(Ci.nsIStyleSheetService),
css = `@-moz-document url(chrome://browser/content/browser.xhtml){
	:is(${id})[rst] {filter: grayscale(1%) !important}
	:root:not([chromehidden*=toolbar]) #tabbrowser-tabbox {background-color: black !important}
	:root:not([chromehidden*=toolbar]) #tabbrowser-tabpanels {opacity:${getIntPref(tabr)/100} !important}}`;
Services.io.getProtocolHandler("resource").QueryInterface(Ci.nsIResProtocolHandler)
	.setSubstitution(tabr,Services.io.newURI("data:text/css,"+ encodeURIComponent(css)));
sss.loadAndRegisterSheet(Services.io.newURI(url),sss.USER_SHEET);
var st = InspectorUtils.getAllStyleSheets(document).find(s => s.href == url).cssRules[0].cssRules[2].style;
var observer = () => st.setProperty("opacity", getIntPref(tabr)/100,"important");
prefs.addObserver(tabr,observer);
this.removePrefObs = () => prefs.removeObserver(tabr,observer); //end bright

css_USER = (css) => { //–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
	var style = FileExists(css) ? Services.io.newURI(css) : makeURI('data:text/css;charset=utf-8,'+ encodeURIComponent(css));
	var args = [style,sss.USER_SHEET]; //—Å—Ç–∏–ª—å: —Ñ–∞–π–ª –∏–ª–∏ CSS
	(this.css = !this.css) ? sss.loadAndRegisterSheet(...args) : sss.unregisterSheet(...args);
},
gClipboard = {write(str,ch = Cc["@mozilla.org/widget/clipboardhelper;1"].getService(Ci.nsIClipboardHelper)){
		(this.write = str => ch.copyStringToClipboard(str,Services.clipboard.kGlobalClipboard))(str);}
},
TabAct = (e) => {return e.closest(".tabbrowser-tab");
},
TabsDel = (right = 0,curr = gBrowser.selectedTab) => { //–∑–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫–∏ —Å–ª–µ–≤–∞/—Å–ø—Ä–∞–≤–∞ –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π
	var tabs = gBrowser.visibleTabs.filter(tab => !tab.pinned), i = tabs.indexOf(curr);
	var a = (i != -1), b = (a ? i + right : !right * tabs.length);
	args = right ? [b, tabs.length] : [0,b];
	tabs.slice(...args).forEach((i) => {gBrowser.removeTab(i)});
},
saveSelToTxt = async () => { //–≤ .txt –í—Å—ë –∏–ª–∏ –í—ã–±—Ä–∞–Ω–Ω–æ–µ
	var {length} = saveURL, splice = length > 9, l11 = length == 11, msgName = id + ":Save:GetSelection"; //FIX FF103+
	var receiver = msg => {var txt = "data:text/plain,"+ encodeURIComponent(gBrowser.currentURI.spec +"\n\n"+ msg.data);
		var args = [txt, ucf.Title() +'.txt',null,false,true,null,window.document];
		splice && args.splice(5,0,null) && l11 && args.splice(1,0,null);
		saveURL(...args);
		ucf.toStatus(crop("‚àö —Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω: "+ ucf.Title(),96,''));
	}
	messageManager.addMessageListener(msgName,receiver);
	addDestructor(() => messageManager.removeMessageListener(msgName,receiver));
	var sfunc = fm => {
		var res,fed,win = {},fe = fm.getFocusedElementForWindow(content,true,win);
		var sel = (win = win.value).getSelection();
		if (sel.isCollapsed){
			var ed = fe && fe.editor;
			if (ed && ed instanceof Ci.nsIEditor)
				sel = ed.selection, fed = fe;
		}
		if (sel.isCollapsed)
			fed && fed.blur(),docShell.doCommand("cmd_selectAll"),
			res = win.getSelection().toString(),docShell.doCommand("cmd_selectNone"),
			fed && fed.focus();
		res = res || sel.toString();
		/\S/.test(res) && sendAsyncMessage("saveSelToTxt",res);
	}
	var url = "data:;charset=utf-8,"+ encodeURIComponent(`(${sfunc})`.replace("saveSelToTxt",msgName)) +'(Cc["@mozilla.org/focus-manager;1"].getService(Ci.nsIFocusManager));';
	(saveSelToTxt = () => gBrowser.selectedBrowser.messageManager.loadFrameScript(url,false))();
},
switchTab = (url = 'about:serviceworkers',go = false) => { //–æ—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É | –∑–∞–∫—Ä—ã—Ç—å, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞ | –≤—ã–±—Ä–∞—Ç—å
	for(var tab of gBrowser.visibleTabs)
		if (tab.linkedBrowser.currentURI.spec == url)
			{go ? gBrowser.selectedTab = tab : gBrowser.removeTab(tab); return;}
	gBrowser.addTrustedTab(url);
	gBrowser.selectedTab = gBrowser.visibleTabs[gBrowser.visibleTabs.length -1];
},
openDial = (args = [Ff.c +"options/prefs_win.xhtml","user_chrome_prefs:window","centerscreen,resizable,dialog=no"]) => window.openDialog(...args), //–∏–ª–∏ about:user-chrome-files
tooltip_x = (trg,text = "", ttt = "") => {
	if (!trg.id.endsWith("x")){ //box
		ttt = (trg.hasAttribute("tooltiptext")) ? trg.ttt = trg.tooltipText : trg.ttt;
		if (ttt && ttt.indexOf(text) == -1) ttt += "\n\n";
		trg.removeAttribute("tooltiptext");
	}
	return (ttt.indexOf(text) == -1) ? ttt + text : ttt;
},
bright = (trg,forward,step = 1,val) => { //wheel
	val ||= getIntPref(tabr) + (forward ? step : -step);
	val = val > 100 ? 100 : val < 15 ? 15 : val;
	ucf.pref(tabr,val); trg.toggleAttribute("rst"); ucf.toStatus(T[2] + val +"%",1e3);
},
br_val = () => ucf.pref([tabr,100]) +"%",
zoom = (forward,toggle = false, change = true,text = '') => {
	toggle ? ZoomManager.toggleZoom() : change ? forward ? FullZoom.enlarge() : FullZoom.reduce() : 0;
	ucf.toStatus("¬± –ú–∞—Å—à—Ç–∞–± "+ Math.round(ZoomManager.zoom*100) +`%${ucf.pref("browser.zoom.full") ? "" : " (—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç)"}` + text,3e3);
},
Expert = (m = Boolean(Ff.Exp()),p = Ff.p +'expert') => {
	ucf.pref(p,!m); ucf.toStatus(Over.br_exp(""),3e3);
},
Help = (help = Ff.c +"help.html") => { //–ø–æ–º–æ—â—å
	(FileExists(help)) ? switchTab(help) : switchTab('victor-dobrov.narod.ru/help-FF.html');
},
userjs = (e,myjs = Ff.c +"custom_scripts/User.js") => {
	Debug() && document.getElementById("key_browserConsole").doCommand(); //—Ñ–æ–∫—É—Å –Ω–∞ –∫–æ–Ω—Å–æ–ª—å
	FileExists(myjs) ? eval(Cu.readUTF8URI(Services.io.newURI(myjs))) : t = myjs +" ‚Äî —Å–∫—Ä–∏–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω";
	console.log("‚úÖ\t"+ Math.random(),""); //–≤–∞—à —Å–∫—Ä–∏–ø—Ç
},
translate = (brMM = gBrowser.selectedBrowser.messageManager) => { //–ø–µ—Ä–µ–≤–æ–¥ —Å–∞–π—Ç | –≤—ã–¥–µ–ª. —Ç–µ–∫—Å—Ç
	brMM.addMessageListener('getSelect',listener = (msg) =>{
		if (msg.data) //–≤—ã–¥–µ–ª–µ–Ω–æ
			switchTab("https://translate.google.com/#view=home&op=translate&sl=auto&tl=ru&text="+ msg.data,true)
		else
			switchTab("https://translate.yandex.com/translate?url="+ gURLBar.value +"&dir=&ui=ru&lang=auto-ru",true);
	brMM.removeMessageListener('getSelect',listener,true);
	});
	brMM.loadFrameScript('data:,sendAsyncMessage("getSelect",content.document.getSelection().toString())',false);
},
openProxyWin = (_win = Services.wm.getMostRecentWindow("aTaB:ProxyWin")) => {
	if (_win) _win.focus()
	else {
		_win = openDial(["chrome://browser/content/preferences/dialogs/connection.xhtml","_blank","chrome,dialog=no,centerscreen,resizable"]);
		_win.addEventListener("DOMContentLoaded",() => {
			_win.document.documentElement.setAttribute("windowtype","aTaB:ProxyWin");
		},{once: true});
		_win.opener = window; _win.opener.gSubDialog = {_dialogs: []};}
},
FavItem = (first = true,def_url = 'ua.ru') => { //–ø–µ—Ä–≤—ã–π|–ø–æ—Å–ª. url –ú–µ–Ω—é –∑–∞–∫–ª–∞–¥–æ–∫
	var query = {}, options = {}, folder = PlacesUtils.history.executeQuery(query.value, options.value).root;
	PlacesUtils.history.queryStringToQuery(`place:parent=${PlacesUtils.bookmarks.menuGuid}&excludeQueries=1`,query,options);
	folder.containerOpen = true;
	var max = folder.childCount - 1, type = Ci.nsINavHistoryResultNode.RESULT_TYPE_URI, url;
	if (first) for(var ind = 0; ind <= max; ind++){ //first
		var node = folder.getChild(ind);
		if (node.type == type){url = node.uri; break;}
	} else		for(var ind = max; 0 <= ind; ind--){ //last
		var node = folder.getChild(ind);
		if (node.type == type){url = node.uri; break;}
	}
	url ||= def_url; return url;
},
toFav = () => {with (PlacesUtils.bookmarks){ //–±–µ–∑ –¥–∏–∞–ª–æ–≥–∞
	var url = gBrowser.selectedBrowser.currentURI.spec;
	search({url}).then(async array => {
		if (array.length)
			try {await remove(array);} catch {}
		else
			try {await insert({
				url: Services.io.newURI(url),
				title: (gBrowser.contentTitle || gBrowser.selectedTab.label || url),
				parentGuid: [() => toolbarGuid, () => menuGuid, () => unfiledGuid][prefs.getIntPref("bookmarksparentguid",0)](),
				index: DEFAULT_INDEX
			});} catch {}
	});
}}

(async (id, ad) => { //3 –∫–Ω–æ–ø–∫–∏
CustomizableUI.createWidget({label:`–ü–∞–Ω–µ–ª–∏, –ü–∞–ø–∫–∏`,id: id,tooltiptext: Tag[id],
	onCreated(btn){
		btn.style.setProperty("list-style-image","url(chrome://devtools/skin/images/folder.svg)");
	}});
CustomizableUI.createWidget({ label:ad.replace('-',' '), id:ad,
	defaultArea: CustomizableUI.AREA_NAVBAR, localized: false,
	onCreated(btn){
		btn.setAttribute("image","data:image/webp;base64,UklGRjwAAABXRUJQVlA4TC8AAAAvD8ADAAoGbSM5Ov6k774XCPFP/0/03/8JGPxzroIzuOW06Ih60Genn1S/gHe+BgA=");
		btn.onmouseenter = btn.onmouseleave = this.onmouse;
		btn.setAttribute("oncommand","handleCommand(this)"); btn.handleCommand = this.handleCommand;
	},
	onmouse: e => e.target.focusedWindow = e.type.endsWith("r") && Services.wm.getMostRecentWindow(null),
	get handleCommand(){delete this.handleCommand;
		return this.handleCommand = btn => {(btn.handleCommand = new btn.ownerGlobal.Function(this.code).bind(btn))();}
	},
	get code(){delete this.code; var s = Ff.c +"custom_scripts/"+ B[14] +".js";
		try {ad = 'this.focusedWindow && this.focusedWindow.focus();\n'+
			Cu.readUTF8URI(Services.io.newURI(s))} catch {ad = `console.error("No script: "+ ${s})`}
		return this.code = ad;
	}})
})(B[5],B[14]);

/* –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ü–∏–π about:config. –õ–µ–≤+Shift | –∫–æ–ª—ë—Å–∏–∫–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞–≤—Ç–æ-–∑–∞–∫—Ä—ã—Ç–∏–µ
	–µ—Å—Ç—å Yellow = font italic, —Ü–≤–µ—Ç = –∫–ª—é—á, –ø—É—Å—Ç–æ:Red
	refresh=false ‚ü≥ tab, true load skip cache, restart=true with confirm, false ‚ÜØ */
CustomizableUI.createWidget({ defaultArea: CustomizableUI.AREA_NAVBAR,
	label: "–ñ—É—Ä–Ω–∞–ª, –ú–µ–Ω—é –æ–ø—Ü–∏–π", localized: false, id: B[6],
	onCreated(btn) {
		btn.setAttribute("image", "data:image/webp;base64,UklGRkYCAABXRUJQVlA4WAoAAAAQAAAAFwAAFwAAQUxQSJcAAAANcGJr25S8mH4SNGxAgsguPCZ0BcMOiDSNRpvVaCTa3AI2qm2e2ofz7OuwgIiYgMzb4kVjGvegnQFAwXgFVnvcOmtnMJtutAa3Vo4mhRMDpWq8AjfU+yQoYf1/oTkTIdUrknKswNQ5yAdDzqgr4CYbsJWQfEyEU5QNEl2eKFM2AAIbjmSIMjwXPGyEdj6Bdn4mj9KO63sAAFZQOCCIAQAAdAgAnQEqGAAYAD6dRppKgoCqgAE4lsAKwgisgG27uzPePSvBIu/Pr0HJqW+AfoAIHl2DrAnRo/G3JBpTx8yE7L6LFQyD+yUNvuRYAAD+7mwmpaoBcsJ1hVKsMI2ucqid8qndm+WEvH4l4il6lA8FPscgnrRHrnSjjyNcfUV21+TkfqOWKou2UvVsZSl1z+jKs760Vij5XCWF9Uo6TZAhKfrJpeILyQYwq2Ee/g1uyEH/dJMI/91DsVpI6i2vV/Jqpd4/KniJtTm1woLvaotA2ikt3eeBaqlHf8WPe++lSWS7fETjgvzzbflp0Rj+v23kbb9e/VjUcPaD83shRuwzEo6CAO/AGxE+Zwbvv9NDsQT6T+S4CCDOFTuMRVv9/0E4P+uK+Vc3bMfQQD05gY/fes+ZX6ZHkvFdMn7zX8LMVvI59p7F806HPD2lBjs4lWWhQ5ckJDNflZL49370shr3/Q9uMJN9i/NVCu4OT7K3+4+/RkAMnjuY09u+3i4y4CldQG789iIAAAA=");
		var doc = btn.ownerDocument, m = nn => doc.createXULElement(nn);
		btn.domParent = null;
		btn.popups = new btn.ownerGlobal.Array();
		this.createPopup(doc, btn, "config", Setup);
		btn.linkedObject = this;
		for(var type of ["contextmenu", "command"])
			btn.setAttribute("on" + type, `linkedObject.${type}(event)`);
		this.addSheet(btn);
		var popup = m("menupopup"), menu = m("menuitem");
		menu.m = m;
		menu.fill = this.fill;
		menu.render = this.render;
		popup.append(menu);
		btn.prepend(popup);
	},
	render(){
		var popup = this.parentNode;
		this.remove();
		this.fill(Menu, popup);
	},
	fill(arr, popup){
		for(var o of arr) if (o) {
			var sub = Array.isArray(o); //–ø–æ–¥–º–µ–Ω—é?
			var name = sub ? "menu" : "menuitem";
			var {lab, inf, cmd, img} = sub ? o.shift() : o;
			var item = this.m(name);
			item.setAttribute("label", lab);
			if (img)
				item.image = img, item.className = name +"-iconic";
			if (inf)
				item.tooltipText = inf;
			sub || cmd && item.setAttribute("oncommand", cmd.toString().replace(/cmd\(.*?\)/,''));
			popup.append(item);
			sub && o.length && this.fill(o, item.appendChild(this.m("menupopup")));
		}
			else popup.append(this.m("menuseparator"));
	},
	addSheet(btn) { //—Ç–µ–∫—Å—Ç –ø–æ–¥ –∫—É—Ä—Å–æ—Ä–æ–º
		var cb = Array.isArray(btn._destructors);
		var id = cb ? btn.id : B[6];
		var css = `#${id} menu[_moz-menuactive] {
			color: ${I[0]} !important;
		}`;
		var args = [
			"data:text/css;charset=utf-8," + encodeURIComponent(css),
			Ci.nsIDOMWindowUtils.USER_SHEET
		];
		if (cb) var destructor = function() {
			this.removeSheetUsingURIString(...args);
		}
		var add = b => b.ownerGlobal.windowUtils.loadSheetUsingURIString(...args);
		(this.addSheet = !cb ? add : btn => {
			add(btn);
			btn._destructors.push({destructor, context: btn.ownerGlobal.windowUtils});
		})(btn);
	},
	createPopup(doc, btn, prop, data) {
		var popup = doc.createXULElement("menupopup");
		btn.popups.push(btn[prop] = popup);
		popup.id = this.id + "-" + prop;
		for (var type of ["popupshowing"])
			popup.setAttribute("on" + type, `parentNode.linkedObject.${type}(event)`);
		for(var obj of data) popup.append(this.createElement(doc, obj));
		btn.append(popup);
	},
	createElement(doc, obj) { //pref
		if (!obj) return doc.createXULElement("menuseparator");
		var pref = doc.ownerGlobal.Object.create(null), node, bool, img;
		for(var [key, val] of Object.entries(obj)) {
			if (key == "pref") {
				var [apref, lab, akey, hint, undef, code] = val; //—Å—Ç—Ä–æ–∫–∞ –º–µ–Ω—é
				pref.pref = apref; pref.lab = lab || apref;
				if (hint) {
					if (RegExp(/\p{L}/,'u').test(hint[0]) && (hint[0] === hint[0].toUpperCase()))
						hint = '\n'+ hint;
					pref.hint = hint;
				}
				if (undef) pref.undef = undef; //–µ—Å–ª–∏ –Ω–µ –º–∞—Å—Å–∏–≤: undef || undef == ""
				if (code) pref.code = code;
			}
			else if (key == "icon") img = val, pref.img = true;
			else if (key != "keys") pref[key] = val;
			else pref.hasVals = true;
		}
		var t = prefs.getPrefType(pref.pref), m = {b: "Bool", n: "Int", s: "String"};
		var str = m[t == prefs.PREF_INVALID ? obj.keys ? (typeof obj.keys[0][0])[0] : "b" : t == prefs.PREF_BOOL ? "b" : t == prefs.PREF_INT ? "n" : "s"]; //String –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é
		pref.get = prefs[`get${str}Pref`];
		var map, set = prefs[`set${str}Pref`];
		if (pref.hasVals) {
			for(var [val,,,,code] of obj.keys)
				code && (map || (map = new Map())).set(val, code);
			if (map) pref.set = (key, val) => {
				set(key, val);
				map.has(val) && eval(map.get(val)); //–∫–æ–¥2 –µ—Å–ª–∏ pref –∏–∑–º–µ–Ω—ë–Ω
			}
		}
		if (!map) pref.set = set;
		node = doc.createXULElement("menu");
		node.className = "menu-iconic";
		img && node.setAttribute("image", img);
		akey && node.setAttribute("accesskey", akey);
		(node.pref = pref).vals = doc.ownerGlobal.Object.create(null);
		this.createRadios(doc,
			str.startsWith("B") && !pref.hasVals ? [[true, "true"], [false, "false"]] : obj.keys,
			node.appendChild(doc.createXULElement("menupopup"))
		);
		if ("Def3el" in obj) pref.noAlt = !("Yellow" in obj);
		return node;
	},
	createRadios(doc, vals, popup) {
		for(var arr of vals) {
			var [val, lab, key, hint] = arr;
			var menuitem = doc.createXULElement("menuitem");
			with (menuitem)
				setAttribute("type","radio"), setAttribute("closemenu","none"), setAttribute("label", popup.parentNode.pref.vals[val] = lab), key && setAttribute("accesskey", key);
			var tip = menuitem.val = val === "" ? "[ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ ]" : val;
			if (hint) tip += "\n" + hint;
			menuitem.tooltipText = `${tip != undefined ? tip + "\n\n" : ""}–∫–ª–∏–∫ —Å Shift –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞–≤—Ç–æ-–∑–∞–∫—Ä—ã—Ç–∏–µ`;
			popup.append(menuitem);
		}
	},
	regexpRefresh: /^(?:view-source:)?(?:https?|ftp)/,
	upd(node) {
		var {pref} = node, def = false, user = false, val; //–µ—Å–ª–∏ –æ–ø—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
		if (prefs.getPrefType(pref.pref) != prefs.PREF_INVALID) {
			try {
				val = pref.defVal = db[pref.get.name](pref.pref); def = true; //–æ–ø—Ü–∏—è –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–ª—É—á–µ–Ω–∞
			} catch {def = false}
			user = prefs.prefHasUserValue(pref.pref);
			if (user) try {val = pref.get(pref.pref, undefined);} catch {}
		}
		if (val == pref.val && def == pref.def && user == pref.user) return;
		pref.val = val; pref.def = def; pref.user = user;
		var exists = def || user;
		if (!exists && pref.undef) //–æ–ø—Ü–∏–∏ –Ω–µ—Ç ? –≤–µ—Ä–Ω—É—Ç—å default
			val = pref.undef[0];
		var hint = hints.get(pref.pref);
		hint ||= val != undefined ? val : "–≠—Ç–∞ –æ–ø—Ü–∏—è –Ω–µ —É–∫–∞–∑–∞–Ω–∞";
		if (hint === "") hint = "[ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ ]";
		hint += "\n" + pref.pref;
		if (pref.hint) hint += "\n" + pref.hint;
		node.tooltipText = hint; //+ —Ç–µ–∫—Å—Ç
		var img = Icon("999"), alt = "Yellow" in pref && val == pref.Yellow, clr = "Gray" in pref && val == pref.Gray, blu = "Blue" in pref && val == pref.Blue;
		if (clr) img = Icon("999"); if (blu) img = Icon("a0f"); if (alt) img = Icon("f80");
		if ("Def3el" in pref)
			if (val == pref.Def3el)
				node.style.removeProperty("color"), img = Icon();
			else {
				node.style.setProperty("color", "#702020", "important");
				if (!alt && !clr && !blu) img = Icon("f26");
			}
		pref.img || node.setAttribute("image", img); //–Ω–µ—Ç Def3el ? —Å–µ—Ä—ã–π
		user
			? node.style.setProperty("font-style", "italic", "important")
			: node.style.removeProperty("font-style");
		var {lab} = pref;
		if (exists && pref.hasVals) {
			if (val in pref.vals) var sfx = pref.vals[val] || val;
			else var sfx = user ? "–¥—Ä—É–≥–æ–µ" : I[5];
			lab += ` ${"restart" in pref ? "‚ÜØ-" : "refresh" in pref ? "-‚ü≥" : "‚Äî"} ${sfx}`;
		}
		lab = exists ? lab : '['+ lab + `${"restart" in pref ? " ‚ÜØ" : "refresh" in pref ? " ‚ü≥" : ""}` +']'+ `${pref.undef ? " - "+ pref.undef[1] : ""}`;
		node.setAttribute("label", lab); //–∏–º—è = [–∏–º—è] –µ—Å–ª–∏ –ø—Ä–µ—Ñ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
	},
	openPopup(popup) {
		var btn = popup.parentNode;
		if (btn.domParent != btn.parentNode) {
			btn.domParent = btn.parentNode;
			if (btn.matches(".widget-overflow-list > :scope"))
				var pos = "after_start";
			else var win = btn.ownerGlobal, {width, height, top, bottom, left, right} =
				btn.closest("toolbar").getBoundingClientRect(), pos = width > height
					? `${win.innerHeight - bottom > top ? "after" : "before"}_start`
					: `${win.innerWidth - right > left ? "end" : "start"}_before`;
			for(var p of btn.popups) p.setAttribute("position", pos);
		}
		popup.openPopup(btn);
	},
	maybeRestart(node, conf) {
		if (conf && !Services.prompt.confirm(null, this.label, "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä?")) return;
		var cancel = Cc["@mozilla.org/supports-PRBool;1"].createInstance(Ci.nsISupportsPRBool);
		Services.obs.notifyObservers(cancel, "quit-application-requested", "restart");
		return cancel.data ? Services.prompt.alert(null, this.label, "–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã—Ö–æ–¥ –æ—Ç–º–µ–Ω—ë–Ω.") : this.restart();
	},
	async restart() {
		var meth = Services.appinfo.inSafeMode ? "restartInSafeMode" : "quit";
		Services.startup[meth](Ci.nsIAppStartup.eAttemptQuit | Ci.nsIAppStartup.eRestart);
	},
	maybeRe(node, fe) {
		var {pref} = node;
		if ("restart" in pref) {
			if (this.maybeRestart(node, pref.restart)) return;
		}
		else this.popupshowing(fe, node.parentNode);
		if ("refresh" in pref) {
			var win = node.ownerGlobal;
			if (this.regexpRefresh.test(win.gBrowser.currentURI.spec)) pref.refresh
				? win.BrowserReloadSkipCache() : win.BrowserReload();}
	},
	maybeClosePopup(e, trg) {
		(e.shiftKey || e.button == 1) || trg.parentNode.hidePopup();
	},
	popupshowing(e, trg = e.target) {
		if (trg.state == "closed") return;
		if (trg.id) {
			for(var node of trg.children) {
				if (node.nodeName.endsWith("r")) continue;
				this.upd(node);
				!e && node.open && this.popupshowing(null, node.querySelector("menupopup"));
			} return;
		}
		var {pref} = trg.closest("menu"), findChecked = true;
		var findDef = "defVal" in pref;
		var checked = trg.querySelector("[checked]");
		if (checked) {
			if (checked.val == pref.val) {
				if (findDef) findChecked = false;
				else return;
			}
			else checked.removeAttribute("checked");
		}
		if (findDef) {
			var def = trg.querySelector("menuitem:not([style*=font-style]");
			if (def)
				if (def.val == pref.defVal) {
					if (findChecked) findDef = false;
					else return;
				}
				else def.style.setProperty("font-style", "italic", "important");
		}
		for(var node of trg.children) if ("val" in node) {
			if (!pref.val && pref.val != "" && pref.undef)
				pref.val = pref.undef[0]; //–æ–ø—Ü–∏–∏ –Ω–µ—Ç ? –≤–µ—Ä–Ω—É—Ç—å default
			if (findChecked && node.val == pref.val) {
				node.setAttribute("checked", true);
				if (findDef) findChecked = false;
				else break;
			}
			if (findDef && node.val == pref.defVal) {
				node.style.removeProperty("font-style");
				if (findChecked) findDef = false;
				else break;}
		}
	},
	command(e, trg = e.target) { //LMB
		if (trg.btn) return;
		var menu = trg.closest("menu"), newVal = trg.val;
		if (!menu || !menu.pref) return;
		this.maybeClosePopup(e, menu);
		menu.pref.code && eval(menu.pref.code); //run1
		if (newVal != menu.pref.val)
			menu.pref.set(menu.pref.pref, newVal), this.maybeRe(menu, true);
	},
	contextmenu(e, trg = e.target) {
		if (!("pref" in trg)) return;
		this.maybeClosePopup(e, trg);
		if (trg.pref.user)
			prefs.clearUserPref(trg.pref.pref), this.maybeRe(trg);
		trg.pref.code && eval(trg.pref.code); //run
	}
});

if (Ff.os == "macosx")
	Object.keys(Tag).forEach((k)=>{ //i —Å—á—ë—Ç—á–∏–∫, –∑–∞–º–µ–Ω–∞ –±—É–∫–≤
		['‚óâ','√ò'].forEach((c,i)=>{Tag[k] = Tag[k].replace(new RegExp(c,'g'),
		['‚¶ø','‚óé'][i])})})
else if (ucf.pref([Ff.p +'winbuttons',false]))
		css_USER('.titlebar-buttonbox {display: none !important}')
	else css_USER(Ff.c +"custom_styles/win_buttons-vitv.css");

})(Ff = {p:'extensions.user_chrome_files.',c:'chrome://user_chrome_files/content/',i:'permissions.default.image',
	os: AppConstants.platform, ver: Services.appinfo.version.replace(/-.*/,''),
	Ctr(m = "‚åò", w = "Ctrl+"){return this.os == "macosx" ? m : w},
	Exp(){return Number(Services.prefs.getBoolPref(this.p +'expert',false))}
},()=>{ //–ø–µ—Ä–µ–Ω–æ—Å –∫–æ–¥–∞ –≤ –∫–æ–Ω–µ—Ü
B = Object.keys(Tag), T = Tag["@"].split('|');
for(let i=16;i<T.length;i++){B.push(T[i]+"BAP",T[i]+"browser-action")}; //—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
FileExists = (file) => {try { //—Ñ–∞–π–ª|–ø–∞–ø–∫–∞ –µ—Å—Ç—å?
	if (!file.startsWith("chrome://"))
		return FileUtils.File(String.raw`${file}`).exists()
	else return Cc["@mozilla.org/chrome/chrome-registry;1"].getService(Ci.nsIXULChromeRegistry).convertChromeURL(Services.io.newURI(file)).QueryInterface(Ci.nsIFileURL).file.exists();
	} catch {}; return false;
},
crop = (s,cut = 33,ch = '‚Ä¶\n') => { //—Å–æ–∫—Ä–∞—Ç–∏—Ç—å/—Ä–∞–∑–±–∏—Ç—å —Å—Ç—Ä–æ–∫—É
	return s.substring(0,cut) +`${s.length > cut - 1 ? `${ch}‚Ä¶${s.substring(s.length - cut + ch.length,s.length)}`: ''}`;
},
tExp = (name,m = Ff.Exp(), t,z)=>{ //‚Ä¶ {–û–±—â–∏–πÔ∏∞–≠–∫—Å–ø–µ—Ä—Ç (m = 1)[Ô∏∞‚Ä¶]}
	t = Tag[name]; z = t.match(/(\{)([\s\S]*?)(\})/gm);
	if (z) z.forEach((k,h) =>{ //—Ç–µ–∫—Å—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∂–∏–º–∞
		h = k.split('Ô∏∞'); if (h && h.length > m)
			t = t.replace(k,h[m].replace(/\{|\}/g,''));})
	return t;
},
{prefs} = Services, db = prefs.getDefaultBranch(""),
Icon = (c = '0c0')=>"data:image/svg+xml;charset=utf-8,<svg viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg'><defs><linearGradient id='a' x1='16' x2='16' y1='32' gradientUnits='userSpaceOnUse'><stop stop-color='%23"+ c +"'/><stop stop-color='%23fff' offset='.8'/></linearGradient><linearGradient id='b' x2='32' y1='16' gradientTransform='matrix(1 0 0 1 2 2)'><stop stop-opacity='.5'/></linearGradient></defs><circle cx='16' cy='16' r='15' fill='url(%23a)' stroke='url(%23b)' stroke-width='2'/></svg>",
I = [AppConstants.platform == "win" ? '#124' : '#e8e8e8', //—Ç–µ–∫—Å—Ç –ø–æ–¥ –∫—É—Ä—Å–æ—Ä–æ–º, –±–µ–∑ Aero #fff
	"https://antizapret.prostovpn.org/proxy.pac", "network.proxy.type", "network.proxy.autoconfig_url", "general.useragent.override", "–ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é", "Mozilla/5.0 (", "browser.cache.memory.enable", "browser.cache.disk.enable"],
window.ucf = { //all ChromeOnly-scripts
	pref(key,set){ //–∏–ª–∏ key = [key,default]
		if (typeof key != "object") key = [key];
		var t = prefs.getPrefType(key[0]), m = {b:"Bool",n:"Int",s:"String"};
		t = m[t == 128 ? "b" : t == 64 ? "n" : t == 32 ? "s" : ""];
		if (set == "get") return t; //—Ç–∏–ø –æ–ø—Ü–∏–∏
		if (!t) t = m[set != undefined ? (typeof set)[0] : (typeof key[1])[0]];
		if (t) if (set != undefined)
			prefs[`set${t}Pref`](key[0],set)
		else
			set = prefs[`get${t}Pref`](...key);
		return set;
	},
	ua(real = false,ua_my = I[4]){ //—Ç–µ–∫—É—â–∏–π –∏–ª–∏ –≤—à–∏—Ç—ã–π –Æ–∑–µ—Ä–ê–≥–µ–Ω—Ç
		ttt = this.pref(ua_my); prefs.clearUserPref(ua_my);
		ua = Cc["@mozilla.org/network/protocol;1?name=http"].getService(Ci.nsIHttpProtocolHandler).userAgent; //–∫–æ—Å—Ç—ã–ª—å
		ttt && this.pref(ua_my,ttt); ttt ||= ua; if (real) ttt = ua; return ttt;
	},
	dirsvcget(){ //–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –ø—É—Ç–∏ + subdirs, –µ—Å–ª–∏ –ø–æ—Å–ª. –æ–ø—Ü–∏—è = "" –≤–µ—Ä–Ω—É—Ç—å –ø—É—Ç—å, –∏–Ω–∞—á–µ –æ—Ç–∫—Ä—ã—Ç—å
		var f, d = [...arguments], r = (d[d.length-1] == ""); (r) && d.pop();
		try {f = Services.dirsvc.get(d[0] || "DfltDwnld",Ci.nsIFile);} catch {f = prefs.getComplexValue("browser.download.dir",Ci.nsIFile)}
		d.slice(1, d.length).forEach((c)=>f.append(c));
		if (r) return f.path; f.exists() && f.launch();
	},
	formatBytes(b = 0,d = 1){ //–æ–±—ä—ë–º –±–∞–π—Ç‚Ä¶–¢–±
		let i = Math.log2(b)/10|0; return parseFloat((b/1024**(i=i<=0?0:i)).toFixed(d))+`${i>0?'KMGT'[i-1]:''}b`;
	},
	about_config(filter){ //–Ω–∞ –æ–ø—Ü–∏—é
		if (gURLBar.value.startsWith("about:config")) switchTab(gURLBar.value);
		var setFilter = (e,input = (e?.target || window.content.document).getElementById("about-config-search")) => {	try {
			if (e || input.value != filter) input.setUserInput(filter);} catch{}
		},
		found = window.switchToTabHavingURI("about:config",true, {relatedToCurrent: true,
			triggeringPrincipal: Services.scriptSecurityManager.getSystemPrincipal()});
		if (found) setFilter(null,window);
		else gBrowser.selectedBrowser.addEventListener("pageshow",setFilter, {once: true});
	},
	toStatus(txt,time = 5e3,StatusPanel = window.StatusPanel){
		if (StatusPanel.update.tid)
			clearTimeout(StatusPanel.update.tid)
		else {
			var {update} = StatusPanel;
			StatusPanel.update = () => {};
			StatusPanel.update.ret = () => {
				StatusPanel.update = update,StatusPanel.update();
		}}
		StatusPanel.update.tid = setTimeout(StatusPanel.update.ret,time);
		StatusPanel._label = txt;
	},
	flash(id,style,color,ms,text,time = 5e3){ //—Å—Ç–∞—Ç—É—Å, –º–∏–≥–∞–Ω–∏–µ
		id = document.getElementById(id || 'urlbar-input-container'); if (!id) return;
		if (style) id.style.filter = style; if (color) id.style.background = color;
		if (ms) setTimeout(() => {
			id.style.removeProperty('filter'),id.style.removeProperty('background-color');},ms);
		if (text) ucf.toStatus(text,time);
	},
	mode_skin(text,p,t,s = 'unset',o = '',z){with(this){setTimeout(()=>{ //–ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
		if (pref("dom.security.https_only_mode"))
			flash(B[10],"drop-shadow(0px 0.5px 0px #F8F)"),o = ', —Ç–æ–ª—å–∫–æ HTTPS'
		else flash(B[10],"none");
		if (ua() && (ua() != ua(true))) o = o +', —á—É–∂–æ–π –Æ–∑–µ—Ä–ê–≥–µ–Ω—Ç';
		z = pref("network.proxy.no_proxies_on") == "" ? "" : ", –ï—Å—Ç—å —Å–∞–π—Ç—ã-–∏—Å–∫–ª—é—á–µ–Ω–∏—è";
		p = p || pref(I[2]);
		if (p == 1) t = ['sepia(100%) saturate(150%) brightness(0.9)', '–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏'+ z];
		else if (p == 2) t = ['hue-rotate(120deg) saturate(70%)',T[1] + z],s = 'hue-rotate(270deg) brightness(95%)';
		else if (p == 4) t = ['hue-rotate(250deg) brightness(0.95) saturate(150%)','–°–µ—Ç—å - –∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏'+ z];
		else if (p == 0) t = ['saturate(0%) brightness(0.95)','–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ - —Å–∏—Å—Ç–µ–º–Ω—ã–µ'+ z];
		else t = [s,'–°–µ—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø—Ä–æ–∫—Å–∏']; //—Å–µ—Ä—ã–π —Ñ–æ–Ω –∫–Ω–æ–ø–∫–∏
		flash(B[0], pref(Ff.i) > 1 ? "hue-rotate(180deg) drop-shadow(0px 0.5px 0px #F68)" : "none");
		flash(B[6],s); flash(B[1],t[0]);
		z = typeof(text); if (z == 'string')
			toStatus(text ? text : "\u{26A1}"+ t[1] + o,5e3); //—Å–≤–µ—Ç–æ—Ñ–æ—Ä
	},250)}},
	switchProxy(pac = I[1]){
		var t = I[2],u = I[3];
		if (this.pref(t) != 2) //–≤—ã–∫–ª—é—á–∏—Ç—å
			this.pref(t,2), this.pref(u,pac)
		else
			this.pref(t,5), this.pref(u,"localhost");
		this.mode_skin(); //—Ä–∞–∑–Ω—ã–π —Ñ–æ–Ω –∑–∞–º–∫–∞ –¥–ª—è –ü—Ä–æ–∫—Å–∏
		BrowserReload();
	},
	Title(n){try {return Cu.getGlobalForObject(Cu)[Symbol.for("TitlePath")](window,n)[3]
		} catch {return document.title || gBrowser.selectedTab.label}},
	HTML(){
		var inf = [crop("‚àö —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–ø–∏—Å–∞–Ω–∞: "+ this.Title(),48,''),7e3], sfile = document.getElementById(B[18]); //—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ SingleFile
		try {Cu.getGlobalForObject(Cu)[Symbol.for("SingleHTML")](true,window); //SingleHTML.jsm
			gBrowser.selectedTab.textLabel.style.textDecoration = "overline"; //^–æ—Ç–º–µ—Ç–∫–∞
		} catch {if (sfile) sfile.click(), inf = ''
			else inf = ['‚òπ –û—à–∏–±–∫–∞ SingleHTML.jsm',1e4];
		}
		this.toStatus(...inf);
	}
}, ua = ucf.ua(true), //real –Æ–∑–µ—Ä–ê–≥–µ–Ω—Ç
fonts = arr => arr.map(n => [(n == arr[arr.length-1] ? null : n), n]), //array —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏
serif = fonts("Arial|Cantarell|DejaVu Sans|Roboto|PT Serif|Segoe UI|Ubuntu|Cambria|Fira Sans|Georgia|Noto Sans|Calibri|Times".split('|')), sans = [["PT Sans","PT Sans"], ...serif],
hints = new Map([ //–æ–ø—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ? –≤–µ—Ä–Ω—É—Ç—å —Å—Ç—Ä–æ–∫—É
	["ucf.savedirs", crop(ucf.dirsvcget(''),34)], [I[4], ucf.ua()]]);
});